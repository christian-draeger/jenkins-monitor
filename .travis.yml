language: java

install: true

matrix:
  include:
  - jdk: oraclejdk8

script:
- mvn clean install

before_deploy:
- git config --global user.email "builds@travis-ci.com"
- git config --global user.name "Travis CI"
- export GIT_TAG=$TRAVIS_BRANCH-v$TRAVIS_BUILD_NUMBER
- export JAR=$(ls target/jenkins-monitor-*.jar)
- export DEB=$(ls target/jenkins-monitor-*.deb)
- git tag $GIT_TAG -a -m "Generated tag from TravisCI for build $TRAVIS_BUILD_NUMBER"
- git push -q https://$GITPERM@github.com/christian-draeger/jenkins-monitor --tags
- ls -R
#branches:
#  except:
#  - "/^*-v[0-9]/"
deploy:
  provider: releases
  api_key:
    secure: $GITPERM
  file:
    - $JAR
    - $DEB
  skip_cleanup: true
  on:
    tags: true

notifications:
  email:
    on_success: change
    on_failure: change